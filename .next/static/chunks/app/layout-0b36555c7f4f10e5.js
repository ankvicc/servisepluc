(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3148:function(e,t,s){Promise.resolve().then(s.bind(s,8420))},8198:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var r=s(7437),a=s(5879),l=s(2265),n=s(4033);function i(e){let{onSuccess:t,onBack:s}=e,[a,n]=(0,l.useState)({name:"",email:"",password:""}),[i,o]=(0,l.useState)(""),[c,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1),x=e=>{let{name:t,value:s}=e.target;n(e=>({...e,[t]:s}))},h=async e=>{e.preventDefault(),d(!0),o("");try{let e=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),s=await e.json();if(!e.ok)throw Error(s.error||"Ошибка при регистрации");o("Регистрация успешна!"),t&&t()}catch(e){o(e instanceof Error?e.message:"Ошибка при регистрации")}finally{d(!1)}};return(0,r.jsxs)("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[s&&(0,r.jsx)("button",{onClick:s,className:"text-gray-600 hover:text-gray-800",children:"← Назад"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-center flex-grow",children:"Регистрация"})]}),i&&(0,r.jsx)("div",{className:"mb-4 p-3 rounded text-sm ".concat(i.includes("успешна")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:i}),(0,r.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Имя"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",value:a.name,onChange:x,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ваше имя",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:a.email,onChange:x,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"example@mail.com",required:!0})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Пароль"}),(0,r.jsx)("input",{type:u?"text":"password",id:"password",name:"password",value:a.password,onChange:x,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"••••••••",required:!0}),(0,r.jsx)("button",{type:"button",onClick:()=>m(!u),className:"absolute right-2 top-8 text-gray-500 hover:text-gray-700",children:u?"\uD83D\uDE48":"\uD83D\uDC41️"})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)("button",{type:"submit",disabled:c,className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat(c?"opacity-70 cursor-not-allowed":""),children:c?"Регистрация...":"Зарегистрироваться"})})]})]})}function o(e){let{onSuccess:t}=e,{login:s}=(0,a.a)(),o=(0,n.useRouter)(),[c,d]=(0,l.useState)({email:"",password:""}),[u,m]=(0,l.useState)(""),[x,h]=(0,l.useState)(!1),[f,b]=(0,l.useState)(!1),[p,g]=(0,l.useState)(!1),j=e=>{let{name:t,value:s}=e.target;d(e=>({...e,[t]:s}))},y=async e=>{e.preventDefault(),h(!0),m("");try{let e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!e.ok){let t=await e.json();throw Error(t.error||"Ошибка авторизации")}let{token:r}=await e.json();s(r),o.refresh(),o.push("/profile"),t&&t()}catch(e){m(e instanceof Error?e.message:"Ошибка авторизации")}finally{h(!1)}};return p?(0,r.jsx)(i,{onSuccess:()=>{g(!1),t&&t()},onBack:()=>g(!1)}):(0,r.jsxs)("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Вход в аккаунт"}),u&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded text-sm",children:u}),(0,r.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:c.email,onChange:j,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"example@mail.com",required:!0,autoComplete:"username"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Пароль"}),(0,r.jsx)("input",{type:f?"text":"password",id:"password",name:"password",value:c.password,onChange:j,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"••••••••",required:!0,autoComplete:"current-password"}),(0,r.jsx)("button",{type:"button",onClick:()=>b(!f),className:"absolute right-2 top-8 text-gray-500 hover:text-gray-700",children:f?"\uD83D\uDE48":"\uD83D\uDC41️"})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)("button",{type:"submit",disabled:x,className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat(x?"opacity-70 cursor-not-allowed":""),children:x?"Вход...":"Войти"})})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 mt-4 text-center",children:["Нет аккаунта?"," ",(0,r.jsx)("button",{onClick:()=>g(!0),className:"font-medium text-blue-600 hover:text-blue-500 hover:underline focus:outline-none",children:"Зарегистрироваться"})]})]})}},5879:function(e,t,s){"use strict";s.d(t,{H:function(){return c},a:function(){return d}});var r=s(7437),a=s(2265),l=s(4033),n=s(3822),i=s.n(n);let o=(0,a.createContext)({isAuthenticated:!1,user:null,login:()=>{},logout:()=>{},updateUser:()=>{}}),c=e=>{let{children:t}=e,[s,n]=(0,a.useState)(null),c=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("token");if(e)try{let t=i().decode(e);t&&n({id:t.userId})}catch(e){d()}},[]);let d=()=>{localStorage.removeItem("token"),n(null),c.push("/")};return(0,r.jsx)(o.Provider,{value:{isAuthenticated:!!s,user:s,login:e=>{let t=i().decode(e);localStorage.setItem("token",e),n({id:t.userId})},logout:d,updateUser:e=>{n(t=>t?{...t,...e}:null)}},children:t})},d=()=>{let e=(0,a.useContext)(o);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8420:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var r=s(7437),a=s(5879),l=s(1396),n=s.n(l),i=s(4033),o=s(2265),c=s(8198),d=e=>{let{isOpen:t,onClose:s,children:a}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity",onClick:s,children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"​"}),(0,r.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:a})})]})}):null},u=()=>{let{isAuthenticated:e,logout:t}=(0,a.a)(),[s,l]=(0,o.useState)(!1);return(0,i.useRouter)(),(0,r.jsxs)("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:[(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-3 flex items-center justify-between relative",children:[(0,r.jsxs)(n(),{href:"/",className:"text-[20px] font-semibold text-gray-800 hover:text-green-700 transition",children:["Сервис",(0,r.jsx)("span",{className:"text-green-700",children:"Плюс"})]}),(0,r.jsx)("nav",{className:"absolute left-1/2 transform -translate-x-1/2 space-x-6 text-[17px] text-gray-800 hidden md:flex",children:[{href:"/services",text:"Услуги"},{href:"/prices",text:"Цены"},{href:"/sales",text:"Акции"},{href:"/contacts",text:"Контакты"},{href:"/about",text:"О компании"}].map((e,t)=>(0,r.jsx)(n(),{href:e.href,className:"hover:text-blue-600 transition",children:e.text},t))}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n(),{href:"/profile",className:"text-gray-800 hover:text-blue-600 transition",children:"Профиль"}),(0,r.jsx)("button",{onClick:t,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition",children:"Выйти"})]}):(0,r.jsx)("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition",children:"Войти"})})]}),(0,r.jsx)(d,{isOpen:s,onClose:()=>l(!1),children:(0,r.jsx)(c.Z,{onSuccess:()=>l(!1)})})]})},m=()=>(0,r.jsx)("footer",{className:"bg-gray-800 text-white py-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"СервисПлюс"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Профессиональный ремонт и обслуживание техники с 2010 года"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Навигация"}),(0,r.jsx)("ul",{className:"space-y-2",children:[{href:"/about",text:"О компании"},{href:"/contacts",text:"Контакты"},{href:"/privacy",text:"Политика конфиденциальности"}].map((e,t)=>(0,r.jsx)("li",{children:(0,r.jsx)(n(),{href:e.href,className:"text-gray-400 hover:text-white text-sm transition",children:e.text})},t))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Контакты"}),(0,r.jsxs)("address",{className:"text-sm text-gray-400 not-italic",children:["г. Москва, ул. Примерная, д. 10",(0,r.jsx)("br",{}),"+7 (999) 123-45-67",(0,r.jsx)("br",{}),"info@serviceplus.ru"]})]})]}),(0,r.jsxs)("div",{className:"border-t border-gray-700 mt-8 pt-6 text-center text-sm text-gray-400",children:["\xa9 ",new Date().getFullYear()," СервисПлюс. Все права защищены."]})]})});function x(e){let{children:t}=e;return(0,r.jsx)("html",{lang:"ru",children:(0,r.jsx)("body",{className:"flex flex-col min-h-screen bg-gray-50",children:(0,r.jsxs)(a.H,{children:[(0,r.jsx)(u,{}),(0,r.jsx)("main",{className:"flex-grow",children:t}),(0,r.jsx)(m,{})]})})})}s(5610)},5610:function(){},1396:function(e,t,s){e.exports=s(6685)}},function(e){e.O(0,[218,115,685,971,596,744],function(){return e(e.s=3148)}),_N_E=e.O()}]);